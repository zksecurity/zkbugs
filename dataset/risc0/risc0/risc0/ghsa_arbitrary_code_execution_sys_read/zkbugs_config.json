{
  "Arbitrary code execution in guest via memory safety failure in sys_read": {
    "Id": "risc0/risc0/ghsa-jqq4-c7wq-36h7",
    "Project": "https://github.com/risc0/risc0",
    "Commit": "4d8e77965038164ff3831eb42f5d542ab9485680",
    "Fix Commit": "6506123691a5558cba1d2f4b7af734f0367bc6d1",
    "zkVM": true,
    "DSL": "risc0",
    "Vulnerability": "Memory Safety",
    "Impact": "Soundness",
    "Root Cause": "Implementation Bug",
    "Reproduced": false,
    "Location": {
      "Path": "risc0/zkos/v1compat/src/main.rs",
      "Function": "ecall_software",
      "Line": "225"
    },
    "Source": {
      "GitHub Security Advisory": {
        "Source Link": "https://github.com/risc0/risc0/security/advisories/GHSA-jqq4-c7wq-36h7",
        "Bug ID": "GHSA-jqq4-c7wq-36h7: Memory safety failure in sys_read"
      }
    },
    "Commands": {
      "Setup Environment": "./zkbugs_setup.sh",
      "Reproduce": "",
      "Compile and Preprocess": "",
      "Positive Test": "",
      "Find Exploit": "",
      "Clean": "./zkbugs_clean.sh"
    },
    "Short Description of the Vulnerability": "In risc0-zkvm-platform, when the zkVM guest calls sys_read, the host can use a crafted response to write to an arbitrary memory location in the guest due to vulnerable pointer arithmetic. This allows arbitrary code execution within the guest, critically compromising soundness guarantees. All guest programs built with affected versions (risc0-zkvm < 2.3.2 and < 3.0.3) are vulnerable.",
    "Short Description of the Exploit": "Would require a malicious host to craft responses to host_ecall_read with manipulated rlen return values, causing the ecall_software function's pointer arithmetic (buf = buf.add(rlen)) at line 225 to advance the buffer pointer beyond valid guest memory bounds, enabling arbitrary guest memory writes.",
    "Proposed Mitigation": "Fix applied in PR #3351: completely rewrite ecall_software - delete vulnerable implementation (lines 209-240) with manual pointer arithmetic, replace with safe dispatcher pattern that routes syscalls to individual handlers. New sys_read implementation uses assert_user_raw_slice() for bounds checking and slice.chunks_mut() for safe iteration, eliminating manual pointer arithmetic. Fixed in risc0-zkvm versions 2.3.2 and 3.0.3 at lines 225, 227."
  }
}
