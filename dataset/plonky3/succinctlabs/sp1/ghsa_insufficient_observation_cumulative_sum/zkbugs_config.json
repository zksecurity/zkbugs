{
  "Insufficient observation of cumulative sum": {
    "Id": "succinctlabs/sp1/ghsa-8m24-3cfx-9fjw",
    "Project": "https://github.com/succinctlabs/sp1",
    "Commit": "6512b56296c2c5e53b10cce1a741173a3d2dde68",
    "Fix Commit": "79884ffb1a2d10bfd2c272f864033577a052468a",
    "zkVM": true,
    "DSL": "Plonky3",
    "Vulnerability": "Broken Cryptography",
    "Impact": "Soundness",
    "Root Cause": "Fiat-Shamir",
    "Reproduced": true,
    "Location": {
      "Path": "crates/recursion/circuit/src/stark.rs",
      "Function": "verify_shard, build_wrap_circuit",
      "Line": "89, 322-326"
    },
    "Source": {
      "GitHub Security Advisory": {
        "Source Link": "https://github.com/succinctlabs/sp1/security/advisories/GHSA-8m24-3cfx-9fjw",
        "Bug ID": "GHSA-8m24-3cfx-9fjw: Insufficient observation of cumulative sum"
      }
    },
    "Commands": {
      "Setup Environment": "./zkbugs_setup.sh",
      "Reproduce": "./zkbugs_exploit.sh",
      "Compile and Preprocess": "./zkbugs_compile_setup.sh",
      "Positive Test": "",
      "Find Exploit": "",
      "Clean": "./zkbugs_clean.sh"
    },
    "Short Description of the Vulnerability": "During STARK proof generation, the prover must observe all values sent to the verifier into the Fiat-Shamir transcript before sampling challenges. Prior to v3.0.0, the cumulative sum values (global_cumulative_sum and local_cumulative_sum) from the permutation argument were computed and checked to equal zero, but not observed into the challenger before sampling zeta. This violates Fiat-Shamir security by allowing zeta to be sampled from an incomplete transcript. Discovered during SP1 v3.0.0 audit and fixed on October 15, 2024.",
    "Short Description of the Exploit": "Would require crafting a malicious proof that manipulates the cumulative sum without proper Fiat-Shamir observation.",
    "Proposed Mitigation": "Fixed in PR #1638 (Oct 15, 2024). The fix observes global_cumulative_sum and local_cumulative_sum values into the challenger before sampling zeta, ensuring all permutation argument values are included in the Fiat-Shamir transcript. Upgrade to SP1 v3.0.0 or later."
  }
}
