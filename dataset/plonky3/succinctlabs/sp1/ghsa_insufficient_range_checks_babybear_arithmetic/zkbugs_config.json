{
  "Insufficient range checks of BabyBear arithmetic": {
    "Id": "succinctlabs/sp1/ghsa-f77q-r5qm-w4m8",
    "Project": "https://github.com/succinctlabs/sp1",
    "Commit": "798b695ec682fd922698df2b83857ecfc17c3195",
    "Fix Commit": "95d5df798738aaa6b348a3684602737d6ff74014",
    "DSL": "Plonky3",
    "Vulnerability": "Under-Constrained",
    "Impact": "Soundness",
    "Root Cause": "Arithmetic Field Errors",
    "Reproduced": false,
    "Location": {
      "Path": "crates/recursion/gnark-ffi/go/sp1/babybear/",
      "Function": "InvF, InvE",
      "Line": ""
    },
    "Source": {
      "GitHub Security Advisory": {
        "Source Link": "https://github.com/succinctlabs/sp1/security/advisories/GHSA-f77q-r5qm-w4m8",
        "Bug ID": "GHSA-f77q-r5qm-w4m8"
      }
    },
    "Commands": {
      "Setup Environment": "./zkbugs_setup.sh",
      "Reproduce": "./zkbugs_exploit.sh",
      "Compile and Preprocess": "./zkbugs_compile_setup.sh",
      "Positive Test": "./zkbugs_positive_test.sh",
      "Find Exploit": "./zkbugs_find_exploit.sh",
      "Clean": "./zkbugs_clean.sh"
    },
    "Short Description of the Vulnerability": "The Gnark recursion circuit constrains arithmetic over BabyBear when the native field is BN254. Functions like InvF and InvE used values generated by hints that were not appropriately range checked to ensure they were less than the BabyBear modulus, allowing potential soundness violations.",
    "Short Description of the Exploit": "Not reproduced - no test case available.",
    "Proposed Mitigation": "Add proper range checks in InvF and InvE functions to ensure all Bn254 values are constrained to be less than the BabyBear modulus."
  }
}
