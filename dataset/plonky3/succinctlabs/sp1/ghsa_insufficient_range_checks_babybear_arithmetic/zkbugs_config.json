{
  "Insufficient range checks of BabyBear arithmetic": {
    "Id": "succinctlabs/sp1/ghsa-f77q-r5qm-w4m8",
    "Project": "https://github.com/succinctlabs/sp1",
    "Commit": "798b695ec682fd922698df2b83857ecfc17c3195",
    "Fix Commit": "95d5df798738aaa6b348a3684602737d6ff74014",
    "zkVM": true,
    "DSL": "Plonky3",
    "Vulnerability": "Under-Constrained",
    "Impact": "Soundness",
    "Root Cause": "Arithmetic Field Errors",
    "Reproduced": false,
    "Location": {
      "Path": "crates/recursion/gnark-ffi/go/sp1/babybear/babybear.go",
      "Function": "invF, InvE",
      "Line": "136-156 (invF), 255-286 (InvE)"
    },
    "Source": {
      "GitHub Security Advisory": {
        "Source Link": "https://github.com/succinctlabs/sp1/security/advisories/GHSA-f77q-r5qm-w4m8",
        "Bug ID": "GHSA-f77q-r5qm-w4m8: Insufficient range checks of BabyBear arithmetic"
      }
    },
    "Commands": {
      "Setup Environment": "./zkbugs_setup.sh",
      "Reproduce": "./zkbugs_exploit.sh",
      "Compile and Preprocess": "./zkbugs_compile_setup.sh",
      "Positive Test": "",
      "Find Exploit": "",
      "Clean": "./zkbugs_clean.sh"
    },
    "Short Description of the Vulnerability": "The Gnark recursion circuit constrains arithmetic over BabyBear when the native field is BN254. Functions like InvF and InvE used values generated by hints that were not appropriately range checked to ensure they were less than the BabyBear modulus, allowing potential soundness violations.",
    "Short Description of the Exploit": "A malicious prover can provide hint values for inverse calculations that are between 2013265921 (BabyBear modulus) and 2147483647 (2^31-1). These values pass the 31-bit range check but represent invalid BabyBear field elements, potentially allowing the prover to break soundness by using incorrect inverse values that still satisfy the multiplication constraint modulo BN254.",
    "Proposed Mitigation": "Add proper range checks in InvF and InvE functions to ensure all Bn254 values are constrained to be less than the BabyBear modulus."
  }
}
